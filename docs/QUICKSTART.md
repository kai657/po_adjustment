# 快速开始指南

## 一分钟上手

### 1. 准备输入文件

确保以下两个文件在当前目录：
- `shechle_aim.xlsx` - 排程目标
- `po_lists.xlsx` - PO清单

### 2. 执行优化

```bash
python3 run_optimization.py
```

### 3. 查看结果

**输出文件:**
- `po_lists_optimized.xlsx` - 优化后的PO清单（这是你需要的最终结果）
- `comparison_report.xlsx` - 详细对比报告
- `po_comparison.png` - 数量对比图表
- `deviation_comparison.png` - 偏差改善图表

## 结果解读

### 优化后PO清单 (po_lists_optimized.xlsx)

这是调整后的PO清单，可以直接使用。关键变化：
- **修改要货日期** 列已更新为优化后的日期
- 所有日期均为周一
- 日期范围在 2025-10-01 至 2026-06-01 之间
- 已排除节假日

### 对比报告 (comparison_report.xlsx)

**Sheet 1 - 详细对比:**
按 SKU + 周次 展示：
- 目标数量：该周的排程目标
- 原始PO数量：原始PO在该周的汇总
- 优化后PO数量：优化后PO在该周的汇总
- 偏差：与目标的差异

**Sheet 2 - 汇总统计:**
每个SKU的总体效果：
- 改善百分比：偏差减少的比例
- 数值越高，优化效果越好

### 可视化图表

**po_comparison.png:**
- 三色柱状图对比每周的数量
- 蓝色：排程目标
- 紫色：原始PO
- 橙色：优化后PO

**deviation_comparison.png:**
- 展示每周偏差的改善情况
- 红色：原始偏差
- 绿色：优化后偏差
- 绿色柱子越短，说明优化效果越好

## 优化逻辑

算法会自动：
1. 将每个PO订单分配到最优的周一日期
2. 优先保证前2个月（8周）的准确性
3. 在满足偏差最小的前提下，尽量靠近原始日期
4. 避开所有节假日

## 常见问题

**Q: 为什么某些SKU的改善率是0%？**
A: 可能是该SKU在PO清单中没有订单数据

**Q: 如何调整优化参数？**
A: 编辑 `po_optimization.py`，修改以下参数：
- `priority_weeks=8` - 优先保障的周数（默认8周=2个月）
- `weight=10.0` - 前N周的权重（默认10倍）

**Q: 优化需要多长时间？**
A: 通常在1分钟内完成，取决于SKU数量和PO订单数量

## 技巧

1. **查看详细对比**: 打开 comparison_report.xlsx 的"详细对比"表，筛选特定SKU
2. **评估整体效果**: 查看"汇总统计"表的"改善百分比"列
3. **直观理解**: 先看图表（.png文件），再看数据（.xlsx文件）

## 下一步

如果优化效果不理想，检查：
1. PO订单总量是否与排程目标匹配
2. 排程目标是否合理
3. 是否需要调整优先周数或权重参数

---

需要帮助？查看完整文档: [README.md](README.md)
