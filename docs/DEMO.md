# PO清单分箱优化系统 - 演示指南

## 快速演示（5分钟）

### 1. 启动系统

```bash
# 进入项目目录
cd /Users/admin/Downloads/工单调整工具

# 启动Web应用
./start_web.sh

# 或者直接运行
python3 app.py
```

看到以下输出表示启动成功：
```
 * Serving Flask app 'app'
 * Debug mode: on
 * Running on http://0.0.0.0:5001
```

### 2. 访问Web界面

在浏览器中打开：http://localhost:5001

您将看到一个现代化的四步骤界面：

```
┌─────────────────────────────────────────────────┐
│     🎯 PO清单分箱优化系统                        │
│  基于排程目标智能调整要货日期，最小化每周数量偏差  │
└─────────────────────────────────────────────────┘

[ 1.上传文件 ] → [ 2.参数设置 ] → [ 3.执行优化 ] → [ 4.查看结果 ]
```

### 3. 步骤演示

#### 步骤1: 上传文件 📂

**界面展示：**
- 左侧：排程目标文件上传框
- 右侧：PO清单文件上传框

**操作：**
1. 点击左侧"选择文件"，上传 `shechle_aim.xlsx`
2. 点击右侧"选择文件"，上传 `po_lists.xlsx`
3. 点击"上传并预览"按钮

**预期结果：**
- 显示文件信息（行数、SKU数、列名）
- 自动跳转到步骤2

---

#### 步骤2: 参数设置 ⚙️

**可调整参数：**

| 参数 | 默认值 | 说明 |
|------|--------|------|
| 优先保障周数 | 8周 | 前N周的准确性优先级更高 |
| 优先周权重 | 10倍 | 前N周偏差的权重倍数 |
| 日期接近度权重 | 0.01 | 调整后日期尽量接近原日期 |
| 并行进程数 | 4个 | 同时处理的SKU数量 |

**约束条件提示框：**
```
📋 优化约束条件
✓ 要货日期范围: 2025-10-01 至 2026-06-01
✓ 要货日期必须为周一
✓ 自动排除中国法定节假日
✓ 每个SKU独立优化，互不影响
```

**操作：**
- 根据需要调整参数（或使用默认值）
- 点击"下一步"

---

#### 步骤3: 执行优化 🚀

**参数确认表：**
```
参数配置确认
─────────────────────
优先保障周数:    8 周
优先周权重:      10 倍
日期接近度权重:  0.01
并行进程数:      4 个
```

**操作：**
1. 确认参数无误
2. 点击"开始优化"按钮

**执行过程：**
- 显示进度条动画
- 显示进度文字："正在优化中..."
- 通常需要10-60秒（取决于数据量）

---

#### 步骤4: 查看结果 📊

**结果展示包含：**

1. **优化效果汇总卡片**
   ```
   ┌──────────────┬──────────────┬──────────────┬──────────────┐
   │ 处理SKU数    │ 原始总偏差   │ 优化后总偏差 │ 改善率       │
   │     1        │   31,220     │   30,180     │   3.33%      │
   └──────────────┴──────────────┴──────────────┴──────────────┘
   ```

2. **每周数量对比图**
   - 蓝色柱：排程目标
   - 紫色柱：原始PO
   - 橙色柱：优化后PO
   - 横轴：周次 (YYYYWW)
   - 纵轴：数量

3. **偏差改善对比图**
   - 红色柱：原始偏差
   - 绿色柱：优化后偏差
   - 显示改善百分比

4. **下载按钮区域**
   - 📄 优化后PO清单
   - 📊 详细对比报告
   - 📈 数量对比图
   - 📉 偏差对比图

**操作：**
- 查看图表和统计数据
- 点击按钮下载所需文件
- 点击"重新开始"进行新的优化

---

## 完整演示流程图

```
开始
  ↓
启动Web应用 (./start_web.sh)
  ↓
访问 http://localhost:5001
  ↓
┌─────────────────────────────────┐
│ 步骤1: 上传文件                  │
│ • 上传排程目标文件               │
│ • 上传PO清单文件                 │
│ • 点击"上传并预览"               │
└─────────────────────────────────┘
  ↓
┌─────────────────────────────────┐
│ 步骤2: 参数设置                  │
│ • 调整优化参数（或使用默认值）    │
│ • 查看约束条件                   │
│ • 点击"下一步"                   │
└─────────────────────────────────┘
  ↓
┌─────────────────────────────────┐
│ 步骤3: 执行优化                  │
│ • 确认参数配置                   │
│ • 点击"开始优化"                 │
│ • 等待优化完成（显示进度条）      │
└─────────────────────────────────┘
  ↓
┌─────────────────────────────────┐
│ 步骤4: 查看结果                  │
│ • 查看优化效果汇总               │
│ • 查看可视化图表                 │
│ • 下载结果文件                   │
│ • 重新开始或结束                 │
└─────────────────────────────────┘
  ↓
结束
```

## 界面特点

### 1. 现代化设计
- 渐变色背景
- 圆角卡片式布局
- 流畅的动画效果
- 响应式设计（支持移动端）

### 2. 交互友好
- 步骤指示器实时更新
- 文件拖拽上传支持
- 参数实时预览
- Toast消息提示

### 3. 可视化丰富
- 进度条动画
- 统计卡片展示
- 高质量图表
- 颜色编码清晰

### 4. 操作简便
- 一键上传
- 参数预设
- 一键下载
- 重新开始

## 演示技巧

### 技巧1: 快速演示
使用命令行模式快速展示核心功能：
```bash
python3 run_optimization.py
```
30秒内完成整个流程。

### 技巧2: 参数对比
多次运行不同参数，对比优化效果：
- 第1次：默认参数（优先8周，权重10）
- 第2次：增加优先周数（12周）
- 第3次：降低权重（5倍）

### 技巧3: 结果解读
重点展示：
1. 改善率百分比（直观效果）
2. 前8周的偏差对比（重点保障）
3. 图表中绿色柱与红色柱的对比（可视化改善）

### 技巧4: 数据验证
打开Excel文件验证：
1. 所有日期都是周一 ✓
2. 日期范围符合约束 ✓
3. 没有节假日 ✓
4. PO总量不变 ✓

## 常见演示问题

### Q: 演示时优化时间过长？
A: 使用测试数据集（SKU数量少的）或增加并行进程数。

### Q: 图表显示不清晰？
A:
- 下载PNG文件查看高清版
- 打开Excel报告查看详细数据

### Q: 改善率很低或为0？
A:
- 说明原始PO已经比较优化
- 或该SKU在排程目标中不存在
- 这是正常现象，不是错误

### Q: 浏览器兼容性问题？
A: 推荐使用Chrome、Edge、Firefox最新版本。

## 演示脚本示例

### 30秒版本
> "这是一个PO清单优化系统。上传两个文件，点击开始，系统自动调整要货日期，使每周数量更接近排程目标。看，改善率3.33%，偏差明显减少。"

### 2分钟版本
> "让我展示这个智能优化系统的四个步骤：
>
> 1. 首先上传排程目标和PO清单，系统自动预览数据
> 2. 然后调整优化参数，比如优先保障前8周的准确性
> 3. 点击开始优化，系统会自动为每个SKU找到最优的要货日期
> 4. 最后查看结果，可以看到偏差从31220降到30180，改善3.33%
>
> 所有结果都可以下载，包括优化后的PO清单和详细报告。"

### 5分钟版本
> "让我详细演示整个优化流程...
>
> [完整演示每个步骤，解释参数含义，展示结果对比]
>
> ...系统的核心优势是：自动化、智能化、可视化。一键优化，节省大量手工调整时间。"

## 后续探索

演示完成后，建议用户：
1. 阅读 QUICKSTART.md 快速上手
2. 查看 WEB_GUIDE.md 了解详细功能
3. 参考 README.md 深入学习算法原理
4. 尝试不同参数组合，找到最佳配置

---

**祝演示成功！**
